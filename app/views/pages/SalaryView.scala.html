@*
 * Copyright 2020 HM Revenue & Customs
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *@

@import play.api.i18n._
@import uk.gov.hmrc.hmrcfrontend.views.html.components._
@import views.html.components.beforeContent

@this(
        govuk_wrapper: templates.GovukLayoutWrapper,
        formHelper: FormWithCSRF,
        hmrcCurrencyInput: HmrcCurrencyInput,
        h1: components.h1,
        errorSummary: components.errorSummary,
        inputNumber: components.inputNumber,
        p: components.p,
        inputRadio: components.inputRadio,
        button: components.button,
        beforeContent: components.beforeContent
)


@(salaryForm: Form[Salary])(implicit request: Request[_], messages: Messages)

@periodLabels = @{
    Seq("hourly", "daily", "weekly", "monthly", "yearly")
}
@radioFieldAmount = @{
    salaryForm("amount")
}
@radioFieldPeriod = @{
    salaryForm("period")
}
@periodRadioButtons = @{
    periodLabels.map { label =>
        RadioItem(
            content = Text(Messages(s"quick_calc.salary.$label.text")),
            label = Some(Label(content = Text(Messages(s"quick_calc.salary.$label.label")))),
            value = Some(Messages(s"quick_calc.salary.$label.label")),
            checked = radioFieldPeriod.value.contains(Messages(s"quick_calc.salary.$label.label"))
        )
    }
}

@govuk_wrapper(Some(title(salaryForm, Messages("quick_calc.salary.header"))), beforeContentBlock = beforeContent("https://www.gov.uk/estimate-income-tax"), showAppBanner = true) {

    @formHelper(action = controllers.routes.SalaryController.submitSalaryAmount()) {

        @errorSummary(salaryForm.errors)

        @h1(messages("quick_calc.salary.header"))

        @hmrcCurrencyInput(CurrencyInput(
            id = "amount",
            name = "amount",
            label = Label(content = Text(Messages("quick_calc.salary.amount.label"))),
            hint = Some(Hint(
                content = Text(Messages("hint.salary"))
            )),
            value = salaryForm("amount").value,
            classes = "govuk-input--width-10",
            autocomplete = Some("off"),
            errorMessage = salaryForm("amount").error.map(err => ErrorMessage(content = Text(messages(err.args.toString, err.args: _*))))
        ))

        @inputRadio(
            legendAsHeading = false,
            form = salaryForm,
            classes = "",
            legendKey = Messages("label.payperiod"),
            name = "period",
            items = periodRadioButtons
        )

        @button("continue", Some("button-continue"))
    }
}