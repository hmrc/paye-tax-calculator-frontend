@import play.api.i18n._
@import uk.gov.hmrc.payetaxcalculatorfrontend.quickmodel.TaxResult._
@import uk.gov.hmrc.payetaxcalculatorfrontend.quickmodel.QuickCalcAggregateInput

@(quickCalcAggregateInput: QuickCalcAggregateInput, taxYear: String, detailStatus: String)(implicit request: Request[_], messages: Messages)
@summary = @{
  taxCalculation(quickCalcAggregateInput)
}
@tabLabels = @{
  List(Messages("quick_calc.result.tabLabels.year"),
    Messages("quick_calc.result.tabLabels.month"),
    Messages("quick_calc.result.tabLabels.week"))
}

<ul>
@for((breakdown,label)<- summary.taxBreakdown.zip(tabLabels)) {
  <li style="margin:0;" id=@{"tabContent"+breakdown.period}
  data-tab-content=@{breakdown.period}
    class="tab-content"
    role="tabpanel"
    aria-labelledby=@{breakdown.period}>
  <p class="tab-content__first">
<div class="data">
  <div class="transaction-banner--complete">
<p style="margin:10px 0 15px">@{s"${Messages("quick_calc.result.you_take_home")} $taxYear is"}</p>
  <span class="data-item bold-xlarge">£@{s"${moneyFormatter(breakdown.takeHomePay)} ${Messages("a")} ${label.toLowerCase}"}</span>
  </div>
</div>
  <br>
  <p style="font-weight:normal">@{Messages("quick_calc.result.total_deductions.info")}</p>
  <table style="width:100%">
    <thead>
      <tr>
        <th colspan="2"><span style="display: none">@{Messages("quick_calc.result.total_deductions.info")}</span></th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td style="width:66%">@{
          if(summary.taxCode.contains('S')) Messages("quick_calc.result.income_tax_scottish_adjusted")
          else Messages("quick_calc.result.income_tax_adjusted")
        }</td>
        <td>
          £@{
            moneyFormatter(incomeTax(breakdown))
          }
        </td>
      </tr>
      <tr>
        <td style="width:66%">@{Messages("quick_calc.result.your_national_insurance")}</td>
        <td >£@{moneyFormatter(breakdown.taxCategories(1).total)}</td>
      </tr>
      <tr>
        <td style="font-weight: 700; width:66%">@{Messages("quick_calc.result.deductions")}</td>
        <td style="font-weight: 700">£@{moneyFormatter(breakdown.totalDeductions)}</td>
      </tr>
    </tbody>
  </table>

  @{
    if(isOverMaxRate(summary.taxBreakdown.head.grossPay, summary.maxTaxRate, incomeTax(breakdown))){
      <span class="heading-small">{Messages("quick_calc.result.adjusted.head")}</span>
      <p>{Messages("quick_calc.result.adjusted.info")}</p>
    }
  }

  <div class="form-group" style="margin-top:2em">
    <details @detailStatus>
      <summary class="summary">
      @{Messages("quick_calc.result.how_we_calculated")}
      </summary>
      <div>
        <table style="width:100%">
          <thead >
            <tr>
              <th colspan="2" style="font-weight:normal">
                @{s"${Messages("quick_calc.result.how_we_calculated.you_earn_a")} " +
                    s"${Messages("quick_calc.result.how_we_calculated.you_earn_b")} "
                }
              <span style="font-weight: 700">£@{moneyFormatter(breakdown.grossPay)}:</span>
              </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td id="k-adj-key" style="width:66%">@{
                if(summary.taxCode.contains(SCOTTISH_TAX_CODE_PREFIX)) Messages("quick_calc.result.sk_code")
                else Messages("quick_calc.result.k_code")
              }</td>
              <td id="k-adj-value">£@{
                moneyFormatter(breakdown.additionalTaxablePay)
              }</td>
            </tr>
            <tr>
              <td id="tax-free-key" style="width:66%">@{
                if(summary.taxCode.contains(SCOTTISH_TAX_CODE_PREFIX)) Messages("quick_calc.result.tax_free_allowance_scottish")
                else Messages("quick_calc.result.tax_free_allowance")
              }
              <td id="tax-free-value">£@{
                moneyFormatter(breakdown.taxFreePay)
              }</td>
            </tr>
            <tr>
              <td id="taxable-pay-key" style="width:66%">@{Messages("quick_calc.result.taxable_pay")}</td>
              <td id="taxable-pay-value">£@{
                moneyFormatter(breakdown.taxablePay)
              }</td>
            </tr>
          </tbody>
        </table>
      </div>
    </details>
  </div>
  <p>
  </p>
  </li>
}
</ul>



