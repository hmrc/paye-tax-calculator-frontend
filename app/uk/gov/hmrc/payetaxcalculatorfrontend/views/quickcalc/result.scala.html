@import play.api.i18n._
@import uk.gov.hmrc.payetaxcalculatorfrontend.views.html.main_template
@import uk.gov.hmrc.payetaxcalculatorfrontend.quickmodel.TaxResult._
@import uk.gov.hmrc.payetaxcalculatorfrontend.quickmodel.QuickCalcAggregateInput
@import java.time.LocalDate

@(quickCalcAggregateInput: QuickCalcAggregateInput, taxYear: String)(implicit request: Request[_], messages: Messages)
@summary = @{
  taxCalculation(quickCalcAggregateInput)
}
@tabLabels = @{
  List(Messages("quick_calc.result.tabLabels.year"),
    Messages("quick_calc.result.tabLabels.month"),
    Messages("quick_calc.result.tabLabels.week"))
}

@main_template(title = Messages("quick_calc.title"), mainClass = Some("full-width")) {
  <div class="grid-layout--stacked">

    <a href="@uk.gov.hmrc.payetaxcalculatorfrontend.controllers.routes.QuickCalcController.summary()" class="button">@Messages("back")</a>

    <div class="grid-layout__column grid-layout__column--2-3">
      <header class="page-header">
        <h1>@Messages("quick_calc.result.header")</h1>
      </header>

      <div data-tabs>
        <ul class="tabs-nav" role="tablist">
        @for((breakdown, label) <- summary.taxBreakdown.zip(tabLabels)) {
          <li
          id=@{
            breakdown.period
          }
          role="tab"
          data-tab-link=@{
            breakdown.period
          }
          aria-selected="true"
          aria-controls=@{
            "tabContent" + breakdown.period
          }>
            <span class="tabs-nav__tab tabs-nav__tab--active"
            href="#">@label</span>
          </li>
        }
        </ul>

        <ul>
        @for((breakdown, label) <- summary.taxBreakdown.zip(tabLabels)) {
          <li id=@{
            "tabContent" + breakdown.period
          }
          data-tab-content= @{
            breakdown.period
          }
            class="tab-content"
            role="tabpanel"
            aria-labelledby=@{
            breakdown.period
          }>
          <p class="tab-content__first">

        <div class="data">
          <div class="transaction-banner--complete">
            <span class="data-item bold-xsmall">@{s"${Messages("quick_calc.result.you_take_home")} $taxYear"}</span>
            <br/>
            <br/>
            <span class="data-item bold-xlarge">£@{
              breakdown.takeHomePay
            }</span>
          </div>
        </div>
          <br>
          <div class="data">
            <span class="data-item bold-xsmall">@Messages("quick_calc.result.total_deductions")</span>
            <br/>
            <br/>
            <span class="data-item bold-xlarge">£@{
              breakdown.totalDeductions
            }</span>
          </div>
          <br/>
          <details>
            <summary class="summary">
                How we calculated your results
            </summary>
            <div>
              <table>
                <thead >
                  <tr>
                    <th colspan="2">@Messages("quick_calc.result.income")</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>@Messages("quick_calc.result.gross_pay")</td>
                    <td>£@{
                      breakdown.grossPay
                    }</td>
                  </tr>
                  <tr>
                    <td>@Messages("quick_calc.result.tax_free_allowance")</td>
                    <td>£@{
                      breakdown.taxFreePay
                    }</td>
                  </tr>
                  <tr>
                    <td>@Messages("quick_calc.result.taxable_pay")</td>
                    <td>£@{
                      breakdown.taxablePay
                    }</td>
                  </tr>
                </tbody>
                <thead>
                  <tr>
                    <th colspan="2">@Messages("quick_calc.result.deductions")</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>@Messages("quick_calc.result.income_tax")</td>
                    <td>£@{
                      breakdown.taxCategories.head.total
                    }</td>
                  </tr>
                  <tr>
                    <td>@Messages("quick_calc.result.your_national_insurance")</td>
                    <td>£@{
                      breakdown.taxCategories(1).total
                    }</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </details>
          </p>
          </li>
        }
        </ul>
        <p><a href="javascript:window.print()">@Messages("quick_calc.result.info_print")</a></p>

        <p>@Messages("quick_calc.result.info_a")
        <br>@Messages("quick_calc.result.info_b")
        <br>@Messages("quick_calc.result.info_c")
        <br>@Messages("quick_calc.result.info_d")
        <br>@Messages("quick_calc.result.info_e")</p>

      </div>
      <a href="@uk.gov.hmrc.payetaxcalculatorfrontend.controllers.routes.QuickCalcController.restartQuickCalc()" class="button" type="submit">@Messages("restart")</a>
    </div>

    <div class="grid-layout__column grid-layout__column--1-3">
      <aside class="govuk-related-items" role="complementary" style="margin-left: 15px">
        <h2 class="heading-medium" id="subsection-title">@Messages("quick_calc.result.about")</h2>
        <p><a href="https://www.gov.uk/scottish-rate-income-tax" target="_blank">@Messages("quick_calc.result.about_url_a")</a></p>
        <p><a href="https://www.gov.uk/scottish-rate-income-tax" target="_blank">@Messages("quick_calc.result.about_url_b")</a></p>
      </aside>
    </div>

  </div>

}
